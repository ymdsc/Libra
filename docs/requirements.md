# 要件定義書

## はじめに

Libraは個人用の読書管理ウェブアプリケーションです。基本は漫画を扱いますが、ユーザーが設定で変更することで全ての書籍に対応することも可能です。React（Vite + TypeScript）と国会図書館APIを活用し、書籍の検索・登録・読了管理を行うシンプルな学習用アプリです。技術習得を目的とした個人プロジェクトとして、核心機能に集中した設計とします。将来的には、バーコードスキャン機能を追加し、書籍のISBNコードを読み取って検索できるようにします。

## 要件

### 要件1：書籍検索機能

**ユーザーストーリー:** 読者として、タイトル、著者名、ジャンルで書籍を検索したい。そうすることで、簡単に本を見つけてコレクションに追加できる。

#### 受け入れ基準

1. ユーザーが書籍タイトルを入力した時、システムはtitleパラメータを使用して国会図書館APIを検索し、関連する書籍を表示する
2. ユーザーが著者名を入力した時、システムはcreatorパラメータを使用して国会図書館APIを検索し、その著者の書籍を表示する
3. ユーザーがジャンルを選択した時、システムはsubjectパラメータを使用して国会図書館APIを検索し、該当ジャンルの書籍を表示する
4. ユーザーが検索を実行した時、システムはタイトル、サムネイル、著者（可能であれば）を含む書籍結果を表示する
5. 検索結果が見つからない場合、システムは適切な「結果なし」メッセージを表示する
6. 検索結果が表示された時、ユーザーは任意の書籍を個人ライブラリに追加できる

### 要件2：個人ライブラリ管理

**ユーザーストーリー:** 読者として、個人の書籍ライブラリを維持したい。そうすることで、読書コレクションを追跡できる。

#### 受け入れ基準

1. ユーザーが検索結果から書籍を追加した時、システムは現在の日付と共に書籍をローカルストレージに保存する
2. ユーザーがライブラリを表示した時、システムはサムネイルと共に登録済みの全書籍を表示する
3. ユーザーが書籍を削除したい時、システムは削除オプションを提供し、ローカルストレージから削除する
4. 書籍が追加された時、システムは自動的にaddedDateを記録する
5. ライブラリが空の時、システムは適切な空状態メッセージを表示する
6. 設定から書籍も扱う変更をしたユーザーはライブラリ内で書籍をジャンル別に分類して表示することができる
7. ユーザーはライブラリ内で任意のグループを作成・編集・追加ができ、ライブラリ内を整理することができる
8. ライブラリを表示した時、システムは既読と未読の書籍を視覚的に区別し、表示切り替えを提供する
9. ユーザーがライブラリの並び替えを選択した時、システムは追加日順、既読日順、タイトル順、著者順、評価順での並び替えオプションを提供する

### 要件3：読書進捗管理

**ユーザーストーリー:** 読者として、読書進捗を追跡したい。そうすることで、完読した書籍を管理できる。

#### 受け入れ基準

1. ユーザーが書籍の詳細を表示した時、システムは現在の読書ステータス（既読/未読）を表示する
2. ユーザーが書籍を既読にマークした時、システムはisReadをtrueに更新し、readDateを現在の日付に自動設定する
3. ユーザーが書籍を未読にマークした時、既読日が設定されている場合、システムは注意のポップアップを表示し、確認後にisReadをfalseに更新してreadDateをクリアする
4. ライブラリを表示した時、システムは既読と未読の書籍を視覚的に区別する
5. ライブラリで既読日順に並び替えた時のみ、システムはreadDateを表示する
6. 書籍の読書ステータスが変更された時、システムは変更をローカルストレージに保存する
7. ユーザーが書籍の詳細を表示した時、システムは書籍の評価を設定・表示する機能を提供する（点数、星のレート、または文章による評価）
8. ユーザーが書籍の評価を変更した時、システムは評価をローカルストレージに保存し、ライブラリ表示に反映する

### 要件4：書籍詳細表示

**ユーザーストーリー:** 読者として、書籍の詳細情報を表示したい。そうすることで、十分な情報に基づいて読書の判断ができる。

#### 受け入れ基準

1. ユーザーがライブラリから書籍を選択した時、システムは利用可能な全情報を含む詳細ビューを表示する
2. 書籍詳細を表示した時、システムはタイトル、著者、ISBN、説明、サムネイル、読書ステータスを表示する
3. 書籍詳細を表示した時、システムはaddedDateと（該当する場合）readDateを表示する
4. 詳細画面で、ユーザーは読書ステータスを切り替えることができる
5. 詳細画面で、ユーザーは前回の画面に戻ることができる

### 要件5：エラーハンドリング

**ユーザーストーリー:** ユーザーとして、アプリがAPI制限を適切に処理してほしい。そうすることで、エラーが発生してもアプリを継続して使用できる。

#### 受け入れ基準

1. 国会図書館APIが利用できない時、システムは適切なエラーメッセージを表示する
2. APIの制限に達した時、システムはユーザーに通知し、後で再試行するよう提案する
3. ネットワーク接続が不安定な時、システムはローディングインジケーターとタイムアウト処理を提供する
4. APIレスポンスが不正な形式の時、システムはクラッシュすることなく適切にエラーを処理する
5. ローカルストレージ操作が失敗した時、システムはユーザーに通知し、アプリの安定性を維持する

### 要件6：ユーザーインターフェース

**ユーザーストーリー:** ユーザーとして、シンプルで直感的なインターフェースが欲しい。そうすることで、簡単にナビゲートしてアプリを使用できる。

#### 受け入れ基準

1. アプリが起動した時、システムは検索とライブラリの2つの画面を持つメインナビゲーションを表示する
2. 画面間をナビゲートした時、システムは現在の場所の明確な視覚的フィードバックを提供する
3. アクションを実行した時、システムは適切なローディング状態とフィードバックを提供する
4. 書籍情報を表示した時、システムは利用可能な場合はサムネイルを、そうでなければプレースホルダー画像を表示する
5. システムはレスポンシブデザインを適用し、デスクトップとモバイルブラウザの両方で適切に表示する
6. システムは主要なモダンブラウザ（Chrome、Safari、Firefox、Edge）で一貫した表示を提供する

### 要件7：デザインシステム

**ユーザーストーリー:** ユーザーとして、一貫したデザイン体験を得たい。そうすることで、アプリ全体で統一感のある使いやすいインターフェースを利用できる。

#### 受け入れ基準

1. アプリが起動した時、システムは統一されたカラーパレットとタイポグラフィを適用する
2. 全ての画面で、システムは一貫したスペーシングと装飾スタイルを使用する
3. コンポーネントが表示された時、システムは統一されたボタン、カード、入力フィールドのスタイルを適用する
4. デザイン要素が変更された時、システムは全体に一貫して反映される
5. テーマが適用された時、システムは全ての画面で統一されたビジュアル体験を提供する
6. デザインシステムを実装する時、システムはUIデザインガイドライン（ui-guidelines.md）に基づいてファイル構成と運用方法を適用する

### 要件8：ユーザー設定

**ユーザーストーリー:** ユーザーとして、アプリの設定をカスタマイズしたい。そうすることで、個人の好みに合わせてアプリを使用できる。

#### 受け入れ基準

1. アプリが表示された時、システムはユーザーアイコンまたは設定アクセスポイントを提供する
2. ユーザーが設定にアクセスした時、システムは設定画面を表示する
3. 設定画面で、ユーザーは文字サイズを変更できる
4. 設定画面で、ユーザーはダークモードとライトモードを切り替えできる
5. 設定が変更された時、システムは変更をローカルストレージに保存し、アプリ全体に即座に反映する
6. アプリが再起動された時、システムは保存された設定を読み込み適用する

### 要件9：バーコードスキャン機能（将来実装）

**ユーザーストーリー:** 読者として、書籍のバーコード（ISBN）をスキャンして検索したい。そうすることで、手動入力なしで素早く本を見つけてコレクションに追加できる。

#### 受け入れ基準

1. ユーザーがバーコードスキャンボタンをクリックした時、システムはブラウザのカメラAPIを通じてカメラへのアクセス許可を要求する
2. カメラアクセスが許可された時、システムはバーコードスキャン画面を表示する
3. ユーザーが書籍のバーコードをカメラにかざした時、システムはISBNコードを認識して自動的に検索を実行する
4. バーコードスキャンが成功した時、システムは該当する書籍の詳細情報を表示する
5. バーコードスキャンが失敗した時、システムは適切なエラーメッセージと手動入力オプションを提供する
6. カメラアクセスが拒否された、またはカメラが利用できない環境の時、システムはISBNの手動入力フォームを表示する
7. スキャン結果から書籍が見つかった時、ユーザーは個人ライブラリに追加できる
8. スキャン結果から書籍が見つからなかった時、システムは適切な「結果なし」メッセージを表示する